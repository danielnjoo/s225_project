---
title: "Travel in Developed and Developing Countries"
author: "Jocelyn, Daniel"
date: "3/1/2018"
output:
  pdf_document:
    fig_height: 3
    fig_width: 7
  html_document: default
---

# Technical Appendix

```{r, include = FALSE}
library(tidyverse)
require(mosaic)
require(NSM3)
require(readr)
require(Rfit)
require(ggplot2)
require(dunn.test)
```

## Data Summary

### Data Read-In:
```{r, message = FALSE, warning = FALSE}
groupfdata <- read_csv("https://awagaman.people.amherst.edu/stat225/datasetsS2018/groupFdata.csv") 
groupfdata <- groupfdata %>% dplyr::select(-X1)

#data <- read.csv("Data/final_data.csv") %>% .[2:ncol(.)]
#data %>% dim()
```

The dataset includes 49 variables and 33,559 flights.

### Variables:
```{r}
# summary(groupfdata)
```

**Categorical Variables:**

- airline
- airline.ID
- source.airport
- source.airport.id 
- destination.apirport
- destination.airport.id
- codeshare ("Y" if codeshare, empty otherwise)
- stops ("0" for direct flight)
- equipment (3-letter codes for plane types generally used on the flight, seperated by spaces if more than one)
- source.airport.name
- source.country
- destination.airport.name
- destination.country
- Country.Code.x 
- developed.x (0 = developing; 1 = developed)
- Country.Code.y
- developed.y (0 = developing; 1 = developed)

**Quantitative Variables:**

- X2010.x:X2016.x (GDP each year from 2010 - 2016)
- growth10_11.x:growth15_16.x (GDP growth between two years from 2010 - 2016)
- avg_growth.x
- X2010.y:X2016.y (GDP each year from 2010 - 2016)
- growth10_11.y:growth15_16.y (GDP growth between two years from 2010 - 2016)
- avg_growth.y

**Please note** that a variable name with a '.x' corresponds to the source country of the flight and a variable name with a '.y' corresponds to the destination country of the flight. Additionally, `developed` is a categorical variable that indicates whether a country is developing or developed using the GDP cutoff of 10,490 dollars. This value is inflation adjusted from 12,000 today's dollars.

## Preliminary Univariate Analysis

### Countries

```{r}
groupfdata$source.country %>% unique() %>% length()
groupfdata$destination.country %>% unique() %>% length()
```

156 unique source and destination countries.

```{r}
length(which(groupfdata$developed.x==1))/nrow(groupfdata)
```

Of which 68% of the outbound countries are developed.

```{r}
length(which(groupfdata$developed.y==1))/nrow(groupfdata)
```

And 68% of the inbound countries are developed.

Numbers of flights for each source country over entire dataset:

```{r, fig.height=6, fig.width=7}
groupfdata %>% group_by(Country.Code.x, developed.x) %>% summarize(count=n()) -> temp 
temp %>% ggplot(aes(Country.Code.x,count, fill=as.factor(developed.x))) + 
  geom_bar(stat='identity') + 
  coord_flip() + 
  labs(title = "Number of Flights per Source Country", x = "Country", y = "Count")
```

The developing outlier is China:

```{r}
temp %>% arrange(count) %>% tail(1)
```

After normalizing the flight counts by population, China is no longer an outlier:

```{r, fig.height = 6, fig.width = 7}
groupfdata %>% group_by(Country.Code.x, developed.x, source.population) %>% 
  summarize(count=n()) -> temp

temp <- temp %>% mutate(count = count/source.population) %>% group_by(Country.Code.x,developed.x) %>% summarize(count = sum(count)) # Two very similar values of population for countries? 

temp %>% ggplot(aes(Country.Code.x,count, fill=as.factor(developed.x))) + 
  geom_bar(stat='identity') + 
  coord_flip() + 
  labs(title = "Normalized Number of Flights per Source Country", x = "Country", y = "Count")
```


### Source Country Per Capita GDP

```{r}
# Distribution of GDP:
data2 <- dplyr::select(groupfdata, '2010'=X2010.x, '2011'=X2011.x, '2012'=X2012.x, '2013'=X2013.x, '2014'=X2014.x, '2015'=X2015.x, '2016'=X2016.x, Country.Code.x, developed.x)
data2 <- gather(data2, key = "year", value = "GDP", -Country.Code.x, -developed.x)
```

```{r, warning = FALSE, message = FALSE}
# GDP Each Year:
ggplot(data2, aes(x = GDP, color = year)) + 
  geom_density() +
  ggtitle("Density plot of source countries' GDP by year")
```

We find that in the time period studied (2010-2016), composition of GDP of source countries is mainly consistent. This is likely because the composition of countries themselves is relatively consistent. The orange blip (year=2010) on the lower end of GDP is removed in 2011, which suggests a shift towards higher source country GDPs in later years.

```{r, warning = FALSE, message = FALSE}
# GDP by developed or developing:
ggplot(data2, aes(x = GDP, color = as.factor(developed.x))) + 
  geom_density() + 
  guides(color=guide_legend(title="Developed (1) or Developing (0)")) + 
  ggtitle('Density plot of source countries\' GDP, developed vs. developing') +
  theme(legend.position='bottom')
```

GDP is clearly differentiated by the development status of the source country. Developing countries have a narrower range of Per Capita GDP and the center of this distribution is located at the lower end of the overall Per Capita GDP range. Developed countries have a wider range of Per Capita GDP with a center located aboe the entire distribution of developing Per Capita GDP.

```{r}
# Distribution of GDP Growth:
data3 <- dplyr::select(groupfdata, growth10_11=growth10_11.x, growth11_12=growth11_12.x, growth12_13=growth12_13.x, growth13_14=growth13_14.x, growth14_15=growth14_15.x, growth15_16=growth15_16.x, Country.Code.x, developed.x)
data3 <- gather(data3, key = "year", value = "GDP_Growth", -Country.Code.x, -developed.x)
```

```{r, warning = FALSE, message = FALSE}
# GDP Growth Each Year:
ggplot(data3, aes(x = GDP_Growth, color = year)) + 
  geom_density() + 
  scale_x_continuous(limits=c(-20,20)) +
  ggtitle("Density plot of source country GDP growth")
```

The distributions of Per Capita GDP growth appear to be more variable between different pairs of years than the distribution of Per Capita GDP by year.

```{r, warning = FALSE}
# Distribution of Average GDP Growth:
ggplot(groupfdata, aes(x = avg_growth.x, color = as.factor(developed.x))) + 
  geom_density() +
  guides(color=guide_legend(title="Developed (1) or Developing (0)")) + 
  ggtitle("Density plot of source country average GDP growth by status") + 
  theme(legend.position='bottom')
```

The above is the distribution of the average Per Capita GDP Growth betwen 2010-2016 for developed and developing countries. Average growth for developing countries is shifted above the growth of developed countries. Additionally, the distribution is more symmetric for developed countries and left skewed for developing countries.


### Outbound Flights

```{r, message = FALSE, warning = FALSE}
groupfdata %>% group_by(source.country) %>% summarize(count=n()) -> temp
temp %>% ggplot(aes(count)) + 
  geom_histogram(fill = "blue") +
  labs(title = "Distribution of Outbound Flights Per Source Country",
       x = "Number of Outbound Flights", y = "Count")
```

The distribution of the number of outband flights per source country is heavily right skewed and unimodal. China, once again, is seen as an outlier with approximately $5000$ flights.

```{r}
favstats(temp$count)
```

Looking at some summary statistics for the distribution above, there is a significant difference between the mean ($215.12$) and the median ($46$). Additionally, the standard deviation is incredibly large ($531.39$), while the IQR is much smaller ($150.25$). The differences in mean and median as well as the large standard deviation demonstrate how the skewed distribution and outliers are influencing the mean. We may want to pursue transformations on the data to mitigate this effect.

Below, we identify all countries greater than 2 standard deviations away from the mean: 

```{r}
# Identify Extreme Points:
groupfdata %>% group_by(source.country) %>% summarize(count = n()) %>% 
  filter(count > 1278) %>% arrange(desc(count))
```


### Inbound Flights

```{r, warning = FALSE, message = FALSE}
groupfdata %>% group_by(destination.country) %>% summarize(count=n()) -> temp
temp %>% ggplot(aes(count)) + 
  geom_histogram(fill = "purple") + 
  xlab("number of inbound flights for a country") +
  labs(title = "Distribution of Inbound Flights Per Source Country", 
       x = "Number of Inbound Flights", y = "Count")
```

The distribution of the number of inbound flights per source country is practically identical to the distribution of the number of outbound flights.

```{r}
favstats(temp$count)
```

Again, we see a large standard deviation and big difference between the mean and the median.

Below, we identify all countries greater than 2 standard deviations away from the mean, which are the same countries as above: 

```{r}
# Identify Extreme Points:
groupfdata %>% group_by(destination.country) %>% summarize(count = n()) %>% 
  filter(count > 1276) %>% arrange(desc(count)) 
```


### Developed vs. Developing Countries Outbound Flights

Below, we examine the total number of outbound flights for developing versus developed countries:

```{r, warning = FALSE, message = FALSE}
groupfdata %>% group_by(developed.x) %>% summarize(count=n()) %>% ggplot(aes(as.factor(developed.x),count)) + 
  geom_bar(stat='identity', fill = "blue") + 
  labs(title = "Total Outbound Flights by Development Status",
       x = "Developing (0) vs. Developed (1)", y = "Count")
```

We can very clearly see that there are more outbound flights from developed than developing countries.


## Prediction of Total Number of Flights per Country by Average Growth

Investigating whether GDP growth leads to an increase in the number of flights in the consecutive year is worth investigating, but not available to us given the current dataset which does not inform us of the date of any given flight. Our data does allow us to see if we can predict the total number of flights per country by that countries average Per Capita GDP growth.

### Smoothing

To analyze the relationship between the Total Number of Flights per Country and Average Per Capita GDP, we begin by looking at a scatterplot to verify if the Linearity condition is met and whether or not transformations may be necessary.

```{r, warning = FALSE}
groupfdata %>% group_by(source.country, avg_growth.x) %>% summarize(count=n()) -> temp
temp %>% ggplot(aes(avg_growth.x, count)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se=F) +
  geom_smooth(method = 'loess', se=F, col = "red") +
  labs(title = "Number of Flights vs. Average Growth of Source Country",
       x = "Average Per Capita GDP Growth", y = "Count")
```

The plot above is a scatterplot of the average growth of the source country against the total count of flights for each source country. There does not appear to be any obvious trend in the data as the majority appear to be clustered together. There is one particularly extreme outlier at approximately 2900 flights. As discussed above, this outlier is China. 

The blue line represents the least squares fitted line. From this, we see that there is possibly a positive linear relationship between average growth and the number of flights. Using the `loess` smoother, another fitted line was generated (red). This new fitted line is curved with two small peaks around an average growth of 2.5 and another around 11. This is not a linear line. Additionally, the second peak is in alignment with China and one other outlier, which may suggest that the second peak is a result of the 'pull' of the outliers. To attempt to produce a more linear relationship and remove the influence of outliers, we first normalize by population.

```{r, warning = FALSE}
groupfdata %>% 
  group_by(source.country, avg_growth.x, source.population, developed.x, X2016.x) %>%
  summarize(count=n()) -> temp

normal <- temp %>% mutate(count = count/source.population) %>%
  group_by(source.country, avg_growth.x, developed.x, X2016.x) %>%
  summarize(count = sum(count))

normal %>% ggplot(aes(avg_growth.x, count)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se=F) +
  geom_smooth(method = 'loess', se=F, col = "red") +
  labs(title = "Normalized Number of Flights vs. Average Growth of Source Country",
       x = "Average Per Capita GDP Growth", y = "Normalized Count")
```

Despite normalizing, there are still outliers present. Additionally, for the most part, the observations are still clustered together in no recognizable pattern while a small handful deviate fall above the majority of the data. A transformation may therefore be appropriate. Keeping the normalized data, we can compare average growth to the natural log of the counts.

```{r, warning = FALSE}
normal <- normal %>% mutate(log_count = log(count))

normal %>% ggplot(aes(avg_growth.x, log_count)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se=F) +
  geom_smooth(method = 'loess', se=F, col = "red") +
  labs(title = "Normalized Log Number of Flights Per Source Country vs. Average Growth", 
       x = "Average Per Capita GDP Growth", y = "Natural Log Counts")
```

While the relationship between average growth and the natural log of counts does not appear to be a strong one, it is more linear. The linear regression line (blue) fit through the above scatterplot suggests a weak to moderate, negative association between average growth and the natural log of counts.

The Loess smoother still suggests a more curved relationship between the two variables. There is only one data point above an average growth of 10 that appears to be influencing the smoother. We remove this point below:

```{r, warning = FALSE}
normal_minus <- normal %>% filter(avg_growth.x < 12)
outliers <- normal %>% filter(avg_growth.x > 12)

normal_minus %>% ggplot(aes(avg_growth.x, log_count)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se=F) +
  geom_smooth(method = 'loess', se=F, color = "red") +
  labs(title = "Normalized Log Number of Flights Per Source Country vs. Average Growth", 
       x = "Average Per Capita Growth", y = "Natural Log Counts")

```

The outlier was the Republic of Naura, a small Pacific island country northeast of Australia. Without Nauru, the Loess smoother fits an almost linear line ($Span = 0.75$). For positive `avg_growth.x` values, the smoother is practically linear and deviates only slightly from the least squares fitted line. For negative `avg_growth.x` values, the loess smoothers shows a curve towarnd, away from the least squares fitted line. Despite this, the true estimate of the relationship between the normalized `log_counts` of flights and `avg_growth.x` appears to be linear enough to satisfy the Linearity condition required to proceed with regression.

For this analysis, parametric and non-parametric regression procedures will be carried out on average GDP growth and the normalized, natural log of the number of flights per source country, with the outlier, Nauru, removed.


### Parametric Regression

A parametric, simple linear regression model was then fit on the normalized `log_counts` as the response variable and `avg_growth.x` as the predictor variable. The summary output for the parametric model is below:

```{r}
p_mod <-  lm(log_count ~ avg_growth.x, data = normal_minus)
summary(p_mod)
```

The t-value for the slope coefficient of `avg_growth.x` is $-0.152$ with an associated p-value of $0.00181$. At $\alpha = 0.01$, this is a significant p-value. Before drawing any further conclusions, the conditions must be met. We've already verified that Linearity condition is satisfied and it seems safe to assume that Independence also holds. We verify below that the Equal Variance and Normality conditions are also met:

```{r}
# Conditions:
plot(p_mod, which = 1)
plot(p_mod, which = 2)

```

For the most part, the Equal Variance condition appears to be met. The residuals appear to be randomly clustered, evenly spread, and centered around $0$. Looking at the QQ plot, there is some minor deviation from the reference line at the lower end, but the remainer of the observations adhere to the reference line rather faithfully. Therefore, the Normality condition is also met. 

Since the p-value is small, at $\alpha = 0.01$, we reject the null hypothesis and conclude that the slope coefficient for `avg_growth.x` is significantly different from $0$. In other words, the model suggests that `avg_growth.x` is a significant predictor of the normalized `log_counts` of flights. The coefficient of $-0.152$ indicates that for every 1 unit increase in the `avg_growth.x`, the noramlized `log_counts` is estimated to decrease by approximately $-0.152$. While `avg_growth.x` is a significant predicotr, the model itself has low predictive power. The model only accounts for $3.45$% of the variability in `log_counts` (Multiple $R^{2} = 0.03445$).


### Non-parametric Regression

Although we concluded that all of the conditions for parametric regression were met, we also chose to fit a rank-based, non-parametric regression model on the same variables. This model does not require the residuals to be normally distributed. Since we did see some deviations in the QQplot, this model can be used to affirm the results obtained above. We fit this model below:

```{r}
np_mod <- rfit(log_count ~ avg_growth.x, data = normal_minus)
summary(np_mod, overall = 'drop')
```

The t-value for the slope coefficient of `avg_growth.x` is $-.1683$ with an associated p-value of $0.00049$. At $\alpha = 0.001$, this is a significant p-value. Although we've already verified the Equal Variance condition above, we plot the residuals directly from the our non-parametric model below:


```{r}
plot(np_mod$residuals ~ np_mod$fitted.values)
```

Once again, the residuals appear to be evenly distributed and symmetric about zero. Therefore, we have no concerns regarding the conditions for non-parametric regression.

Both models, parametric and non-parametric, conclude that `avg_growth.x` is a significant predictor of the normalized `log_counts` of flights per source country. The parametric model rejects the null hypothesis at $\alpha = 0.01$. The non-parametric model also rejects the null, but at a smaller $\alpha$ level ($\alpha = 0.001$). Additionally, the slope estimates are very similar. The parametric slope estimate was $-0.152$ and the non-parametric slope estimate was $-0.168$. The estimated intercepts, as well, are quite similar.

Despite this conclusion, both the parametric and non-parametric model have extremely low predictive power (Multiple $R^{2} = 0.03445$, Robust Multiple $R^{2} = 0.0414$). Therefore, although `avg_growth.x` is a significant predictor, this model is essentially useless in terms of predicing the normalized `log_counts`.


## Has Travel Increased in Recently Developed Countries?

Although there is no `year` associated with each flight, we can still determine if the average number of flights (normalized by population size for each country) is significantly greater for recently developed countries versus developing countries. An additional comparison can be made between recently developed countries and established, developed countries.

### Recently Developed Countries

We define a recently developed country as one that was developing in 2010 (Per Capita GDP in 2010 $< 10490.48$), but developed in 2012 (Per Capita GDP in 2012 $> 12,000$).

```{r}
groupfdata %>% group_by(source.country, X2010.x, X2016.x, developed.x) %>% summarize() -> temp
temp %>% mutate(developed.x2 = ifelse(X2016.x>12000,1,0)) -> temp
temp[which(temp$developed.x2-temp$developed.x==1),]
```
> Not sure why getting doubles

We find that 7 of the 156 countries in the dataset were developing in 2010 and developed in 2016.  

```{r, warning = FALSE}
check <- normal %>% mutate(developed.x2 = ifelse(X2016.x > 12000, 1, 0)) %>% 
  mutate(recent_development.x = ifelse(developed.x == 0 & developed.x2 == 0, "Developing", ifelse(developed.x == 0 & developed.x2 == 1, "Recently Developed", "Developed"))) %>% filter(!is.na(recent_development.x))

check2 <- check %>% filter(avg_growth.x < 12) # Remove Nauru (an outlier)

check %>% ggplot(aes(avg_growth.x, log_count, color = recent_development.x)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se=F) +
  labs(title = "Normalized Log Number of Flights vs. Average Growth",
       x = "Average Per Capita GDP Growth", y = "Log Count of Flights")

```

From the above scatterplot, developed countries appear to be clustered at higher normalized `log_count` values across most of the range of average Per Capita GDP growth, with some exceptions. Similarly, developing countries appear to be clustered at lower noramlized `log_count` values across most of the range of average Per Capita GDP growth. There is a region of significant overlap around $-6$ `log_count` for developed and developing. However, the fitted lines suggest that there may be a difference in the average `log_count`. Recently developed countries appear to have lower noramlized `log_count`, with the exception of the Repbulic of Nauru. Additionally, these countries are clustered at the upper half of the average Per Capita GDP growth range. The plot suggests that there may be a difference in center between at least two of the development classifications.


### Parametric ANOVA

To determine if there is a difference in the mean number of normalized, natural log of the number of flights between developed, developing, and recently developed countries, we first fit a parallel slopes model and carry out the parametric ANOVA.

```{r}
p_mod2 <- lm(log_count ~ recent_development.x, data = check)
anova(p_mod2) 
```

The F-value for the parametric ANOVA with `recent_development.x` is $52.583$, with an associated p-value of approximately $0$. Before drawing any further conclusions, the conditions must be met. It seems safe to assume that Independence holds. We verify below that the Equal Variance and Normality conditions are also met:

```{r}
favstats(log_count ~ recent_development.x, data = check) # Fine
plot(p_mod2, which = 1)
plot(p_mod2, which = 2)
check %>% ggplot(aes(recent_development.x, log_count)) + geom_boxplot() +
  labs(title = "Boxplot of Normalized Log Counts by Development Status",
       x = "Development Status", y = "Log Count of Flights")
```

The boxplot and residual plot suggest that the spreads of developed and developing countries appear to be very similar, but the spread of recently developed countries is slightly smaller. Looking at the standard deviations, recently developed countries have the largest, $1.817$, and developed countries have the smallest, $1.394$. Since the ratio of the largest standard deviation to the smallest is less thatn $2$ (approximately $1.303$), the Equal Variance condition appears to be roughly satisfied. 

Additionally, the asymmetry of the recently developed box in the boxplot suggests that we may have concerns for Normality. Looking at the QQ plot, there appears to be some divergence from the reference line near the upper end. While the rest of the QQ plot appears to adhere to the reference line, we still have some concerns regarding whether or not the Normality condition is met.

Therefore, we interpret the p-value associated with the parametric ANOVA with some caution. At all of the most commonly chosen significance levels, this is a significant p-value. We can reject the null hypothesis that there is no difference in the mean normalized `log_counts` between countries of different development status. We conclude that there is at least one difference in means between development status groups. 

From the ANOVA by itself, we cannot determine which pairs have significantly different means. Below, we conduct FIsher's LSD to determine which pairs are significantly different:

```{r}
# Fisher's LSD:
with(check, pairwise.t.test(log_count, recent_development.x))
```

The results of Fisher's LSD suggest that the mean normalized `log_counts` are significantly different between developed and developing countries (p-value $\approx 0$) as well as between developed and recently developed countries (p-value $= 0.0017$), at a significance level of $0.005$. At any significant $\alpha$ level, however, we cannot reject the null hypothesis that there is no difference in means for developing and recently developed countries. 


### Non-Parametric ANOVA

The Non-parametric Kruskal-Wallis test provides an alternative to the one-way Parametric ANOVA. Similar to the ANOVA, it tests for differences in center. Unlike the ANOVA, which tests for differences in means, Kruskal-Wallis tests for difference in medians. The test is run below:

```{r}
kruskal.test(log_count~as.factor(recent_development.x), data=check)
```

The Chi-squared test statiscit for the Kruskal-Wallis test is $86.641$ with an associated p-value of approximately $0$. Since the Kruskal-Wallis test assumes a shift model, we must first verify that such a model is appropriate before drawing any further conclusions. A shift model assumes that the only difference in distributions between the groups (of development status) is their medians. In other words, the shape and spread of each group's distribution should be the same. We verify that assuming that this model holds is appropriate:

```{r}
favstats(log_count~recent_development.x, data=check)
check %>% ggplot(aes(log_count, color = recent_development.x)) + geom_density() +
  labs(title = "Distribution of Normalized Log Count by Development Status",
       x = "Log Count of Flights", y = "Density")
```

The distribution of developed is unimodal and roughly symmetric. The distribution of devloping is unimodal. There is a small peak near $-2.5$, which suggests that perhaps this distribution may actually be bimodal. Additionally, it appears roughly symmetric. The distribution of recently developed has one larger peak and a second peak, which corresponds to the Republic of Nauru. Although there is some deviation in terms of shape, the distributions are roughly similar. 

Since we are looking for differences in medians, we can compare the IQRs of each distribution to compare spread. The IQS for developed, developing, and recently developed are $2.002$, $1.93$, and $1.42$, respectively. While there is some difference in spread, the differences between the IQRs is not drastic. Although not exactly the same in shape and spread, the distributions appear to be close enough to assume a shift model.

Therefore, we return to our p-value. At all of the most commonly chosen significance levels, this is a significant p-value. We can reject the null hypothesis that there is no difference in the median normalized `log_counts` between countries of different development status. We conclude that there is at least one difference in medians between development status groups. 

Although we've concluded that a difference is present, we cannot determine which pairs have significantly different medians Below, we conduct pairwise Kruskal-Wallis Rank Sum tests and the Dunn test to determine which pairs are significantly different:

```{r}
with(check, pairwise.wilcox.test(log_count, recent_development.x))
dunn.test(x = check$log_count, g = check$recent_development.x)
```

The results of the pairwise Rank Sum tests and the Dunn test suggest that the median normalized `log_counts` are significantly different between developed and developing countries (p-value $\approx 0$) as well as between developed and recently developed countries (p-value $= .00054 & = .0002$), at a significance level of $0.005$. At any significant $\alpha$ level, however, we cannot conclude that there is a difference in medians between developing and recently developed countries.

Since the Kruskal-Wallis test has less stringent conditions than the parametric ANOVA, it is a less powerful test. However, despite difference in power, both tests concluded that there was at least one difference in the center of the noramlized `log_counts` between countries with different development status. Additionally, the results of Fisher's LSD, Rank Sum tests, and the Dunn test, all suggested that at $\alpha = 0.005$, there is a significant difference between developed and developing countries and between developed and recently developed countries.

Our results indicate that recently developed countries do not differ from developing countries in terms of the normalized, natural log number of flights. Additionally, since recently developed countries differ from developed countries, we can conclude that travel has not increased in recently developed countries. In other words, recently developed countries are not distinguishable from developing countries in terms of the mean and median noramlized, natural log counts of flights.


## Travel Locations

To answer this question, we are interested in seeing if the proportion of flights to a particular location is different between developed and developing countries. First, we can look at travel outside of one's own country (`source.country $\neq$ `destination.country`):

```{r}
# Developed
hold <- groupfdata %>% filter(destination.country != source.country) %>%
  filter(developed.x == 1) %>%
  group_by(destination.country) %>%
  summarize(count = n()) %>%
  arrange(desc(count)) %>%
  head(5); hold

```

The counts displayed in the table above are not normalized. The most popular destinations for developed countries are the UK, Germany, Spain, Italy, and France.

```{r}
# Developing
hold2 <- groupfdata %>% filter(destination.country != source.country) %>%
  filter(developed.x == 0) %>%
  group_by(destination.country) %>%
  summarize(count = n()) %>%
  arrange(desc(count)) %>%
  head(5); hold2
```

Whereas for developing countries, these destinations are the UAE, Singapore, Japan, France, and China.

If we include travel within one's own country (`source.country` can equal `destination.country`), the results are the same for the developed countries, but differ slightly for the developing ones:

```{r}
hold4 <- groupfdata %>% filter(developed.x == 0) %>%
  group_by(destination.country) %>%
  summarize(count = n()) %>%
  arrange(desc(count)) %>%
  head(5); hold4
```

Now the top five destinations for developing countries are China, India, Indonesia, UAE, and Singapore.

Therefore, it appears that there are differences in the most frequently traveled locations for developed and developing countries.

### Parametric


### Non-Parametric




## Conclusions and Limitations



